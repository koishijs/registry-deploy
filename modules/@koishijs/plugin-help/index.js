var S=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var J=Object.prototype.hasOwnProperty;var A=(t,e)=>()=>(t&&(e=t(t=0)),e);var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var C=(t,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let l of U(e))!J.call(t,l)&&l!==r&&S(t,l,{get:()=>e[l],enumerable:!(a=D(e,l))||a.enumerable});return t},x=(t,e,r)=>(C(t,e,"default"),r&&C(r,e,"default"));var M=t=>C(S({},"__esModule",{value:!0}),t);import{Buffer as P}from"https://registry.koishi.chat/modules/buffer/index.js";import q from"https://registry.koishi.chat/modules/process/index.js";var v=A(()=>{});var b={};import*as se from"https://registry.koishi.chat/modules/koishi/index.js";var z=A(()=>{v();x(b,se)});var oe=L((pe,E)=>{v();var w=Object.defineProperty,V=Object.getOwnPropertyDescriptor,W=Object.getOwnPropertyNames,R=Object.prototype.hasOwnProperty,h=(t,e)=>w(t,"name",{value:e,configurable:!0}),G=(t,e)=>{for(var r in e)w(t,r,{get:e[r],enumerable:!0})},I=(t,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let l of W(e))!R.call(t,l)&&l!==r&&w(t,l,{get:()=>e[l],enumerable:!(a=V(e,l))||a.enumerable});return t},K=t=>I(w({},"__esModule",{value:!0}),t),F={};G(F,{Config:()=>te,apply:()=>N,name:()=>ae});E.exports=K(F);var c=(z(),M(b)),Q={commands:{help:{description:"显示帮助信息",shortcuts:{help:"帮助"},options:{help:"显示此信息",authority:"显示权限设置",showHidden:"查看隐藏的选项和指令"},messages:{"not-found":"指令未找到。","hint-authority":"括号内为对应的最低权限等级","hint-subcommand":"标有星号的表示含有子指令","command-title":"指令：{0}","command-aliases":"别名：{0}。","command-examples":"使用示例：","command-authority":"最低权限：{0} 级。","subcommand-prolog":"可用的子指令有{0}：","global-prolog":"当前可用的指令有{0}：","global-epilog":"输入“{0}help 指令名”查看特定指令的语法和使用示例。","available-options":"可用的选项有：","available-options-with-authority":"可用的选项有（括号内为额外要求的权限等级）："}}}},X={commands:{help:{description:"Show help",options:{help:"show this message",authority:"show authority requirements",showHidden:"show hidden options and commands"},messages:{"not-found":"Command not found.","hint-authority":"this minimum authority is marked in parentheses","hint-subcommand":"those marked with an asterisk have subcommands","command-title":"Command: {0}","command-aliases":"Aliases: {0}.","command-examples":"Examples:","command-authority":"Minimal authority: {0}.","subcommand-prolog":"Available subcommands{0}:","global-prolog":"Available commands{0}:","global-epilog":'Type "{0}help <command>" to see syntax and examples for a specific command.',"available-options":"Available options:","available-options-with-authority":"Available options (parentheses indicate additional authority requirement):"}}}},Y={commands:{help:{description:"ヘルプを表示",options:{help:"このメッセージを表示",authority:"コマンドやオプションの権限を表示",showHidden:"隠しコマンドやオプションを表示"},messages:{"not-found":"コマンドが見つかりません。","hint-authority":"最低権限は括弧にで表示されています","hint-subcommand":"サブコマンドがあるコマンドはアスタリスクで表示されています","command-title":"コマンド：{0}","command-aliases":"別名：{0}。","command-examples":"例：","command-authority":"最低権限：{0}。","subcommand-prolog":"利用可能なサブコマンド{0}：","global-prolog":"利用可能なコマンド{0}：","global-epilog":"「{0}help <command>」を送信してコマンドの使い方を表示します。","available-options":"利用可能なオプション：","available-options-with-authority":"利用可能なオプション（必要な権限は括弧にで表示されています）："}}}},Z={commands:{help:{description:"Afficher l'aide",options:{help:"afficher cette aide",authority:"afficher les droits nécessaires",showHidden:"afficher les options et commandes cachées"},messages:{"not-found":"Commande inconnue.","hint-authority":"les droits minimums sont indiqués entre parenthèses","hint-subcommand":"ces commandes avec un astérisque ont des sous-commandes","command-title":"Commande : {0}","command-aliases":"Alias : {0}.","command-examples":"Exemples :","command-authority":"Droit minimum : {0}.","subcommand-prolog":"Commandes disponibles{0} :","global-prolog":"Commandes disponibles{0} :","global-epilog":'Tapez "{0}help <commande>" pour voir la syntaxe et les exemples pour une commande spécifique.',"available-options":"Options disponibles :","available-options-with-authority":"Options disponibles (les parenthèses indiquent un droit supplémentaire) :"}}}},ee={commands:{help:{description:"顯示幫助信息",options:{help:"顯示當前信息",authority:"顯示權限設定",showHidden:"顯示隱藏的指令和選項"},messages:{"not-found":"未找到指令。","hint-authority":"括弧内為對應的最低權限","hint-subcommand":"附有星號的表示其包含子指令","command-title":"指令：{0}","command-aliases":"別名：{0}。","command-examples":"使用示例：","command-authority":"最低權限：{0} 級。","subcommand-prolog":"可用的子指令有{0}：","global-prolog":"當前可用的子指令有{0}：","global-epilog":"輸入「{0}help 指令名」檢視特定指令的語法及使用示例。","available-options":"可用的選項有：","available-options-with-authority":"可用的選項有（括弧表示額外的權限要求）："}}}},te=c.Schema.object({shortcut:c.Schema.boolean().default(!0).description("是否启用快捷调用。"),options:c.Schema.boolean().default(!0).description("是否为每个指令添加 `-h, --help` 选项。")});function O(t,e){if(t.app.$commander.getCommand("help"))return t.execute({name:"help",args:[e]})}h(O,"executeHelp");var ae="help";function N(t,e){t.i18n.define("zh",Q),t.i18n.define("en",X),t.i18n.define("ja",Y),t.i18n.define("fr",Z),t.i18n.define("zh-TW",ee);function r(n){return n[c.Context.current]=t,n.option("help","-h",{hidden:!0,notUsage:!0,descPath:"commands.help.options.help"})}h(r,"enableHelp"),t.schema.extend("command",c.Schema.object({hideOptions:c.Schema.boolean().description("是否隐藏所有选项。").default(!1).hidden(),hidden:c.Schema.computed(c.Schema.boolean()).description("在帮助菜单中隐藏指令。").default(!1),params:c.Schema.any().description("帮助信息的本地化参数。").hidden()}),900),t.schema.extend("command-option",c.Schema.object({hidden:c.Schema.computed(c.Schema.boolean()).description("在帮助菜单中隐藏选项。").default(!1),params:c.Schema.any().description("帮助信息的本地化参数。").hidden()}),900),e.options!==!1&&(t.$commander._commandList.forEach(r),t.on("command-added",r)),t.before("command/execute",n=>{let{command:i,options:p,session:m}=n;if(p.help&&i._options.help)return O(m,i.name);if(!i._actions.length)return O(m,i.name)});let a=t.$commander;function l(n,i){let p=a.resolve(n);if(p?.match(i))return p;let m=t.i18n.find("commands.(name).shortcuts.(variant)",n).map(s=>({...s,command:a.resolve(s.data.name)})).filter(s=>{var y;return(y=s.command)==null?void 0:y.match(i)}),u=m.filter(s=>s.similarity===1);return u.length?u[0].command:m}h(l,"findCommand");let o=h(n=>(i,p)=>{let{args:[m],session:u}=i,s=l(m,u);if(!Array.isArray(s)){u.collect(n,{...i,command:s,args:[],options:{help:!0}},p);return}for(let{command:y}of s)u.collect(n,{...i,command:y,args:[],options:{help:!0}},p)},"createCollector");async function d(n,i){let p=l(n,i);if(!Array.isArray(p))return p;let m=a.available(i).filter(s=>s&&i.app.i18n.compare(s,n));for(let s of p)m.includes(s.data.name)||m.push(s.data.name);let u=await i.suggest({expect:m,prefix:i.text(".not-found"),suffix:i.text("internal.suggest-command")});return a.resolve(u)}h(d,"inferCommand");let f=t.command("help [command:string]",{authority:0,...e}).userFields(["authority"]).userFields(o("user")).channelFields(o("channel")).option("authority","-a").option("showHidden","-H").action(async({session:n,options:i},p)=>{var m;if(!p){let s=(m=n.resolve(n.app.config.prefix)[0])!=null?m:"",y=a._commandList.filter(B=>B.parent===null),g=H(".global-prolog",n,y,i),_=n.text(".global-epilog",[s]);return _&&g.push(_),g.filter(Boolean).join(`
`)}let u=await d(p,n);if(u)return k(u,n,i)});e.shortcut!==!1&&f.shortcut("help",{i18n:!0,fuzzy:!0})}h(N,"apply");function*$(t,e,r=!1){for(let a of e)!r&&t.resolve(a.config.hidden)||(a.match(t)?yield a:yield*$(t,a.children,r))}h($,"getCommands");function H(t,e,r,a){var l;let o=Array.from($(e,r,a.showHidden)).sort((m,u)=>m.displayName>u.displayName?1:-1);if(!o.length)return[];let d=!1,f=(l=e.resolve(e.app.config.prefix)[0])!=null?l:"",n=o.map(({name:m,displayName:u,config:s,children:y})=>{let g="    "+f+u;if(a.authority){let _=e.resolve(s.authority);g+=` (${_}${y.length?(d=!0,"*"):""})`}return g+="  "+e.text([`commands.${m}.description`,""],s.params),g}),i=[];a.authority&&i.push(e.text(".hint-authority")),d&&i.push(e.text(".hint-subcommand"));let p=i.length?e.text("general.paren",[i.join(e.text("general.comma"))]):"";return n.unshift(e.text(t,[p])),n}h(H,"formatCommands");function j(t,e){return e.user&&t.authority>e.user.authority?!1:!e.resolve(t.hidden)}h(j,"getOptionVisibility");function T(t,e,r){if(t.config.hideOptions&&!r.showHidden)return[];let a=r.showHidden?Object.values(t._options):Object.values(t._options).filter(o=>j(o,e));if(!a.length)return[];let l=[];return Object.values(t._options).forEach(o=>{let d=o.authority&&r.authority?`(${o.authority}) `:"";function f(n,i){var p;if(!r.showHidden&&!j(n,e))return;let m=`${d}${c.h.escape(n.syntax)}`,u=e.text((p=n.descPath)!=null?p:[`commands.${t.name}.options.${i}`,""],n.params);u&&(m+="  "+u),m=t.ctx.chain("help/option",m,n,t,e),l.push("    "+m)}h(f,"pushOption"),"value"in o||f(o,o.name);for(let n in o.variants)f(o.variants[n],`${o.name}.${n}`)}),l.length?(l.unshift(r.authority&&a.some(o=>o.authority)?e.text(".available-options-with-authority"):e.text(".available-options")),l):[]}h(T,"getOptions");async function k(t,e,r){let a=[e.text(".command-title",[t.displayName+t.declaration])],l=e.text([`commands.${t.name}.description`,""],t.config.params);if(l&&a.push(l),e.app.database){let o={command:t,args:[],options:{help:!0}},d=e.collect("user",o);if(await e.observeUser(d),e.subtype==="group"){let f=e.collect("channel",o);await e.observeChannel(f)}}if(t._aliases.length>1&&a.push(e.text(".command-aliases",[Array.from(t._aliases.slice(1)).join("，")])),e.app.emit(e,"help/command",a,t,e),e.user){let o=e.resolve(t.config.authority);o>1&&a.push(e.text(".command-authority",[o]))}if(t._usage)a.push(typeof t._usage=="string"?t._usage:await t._usage(e));else{let o=e.text([`commands.${t.name}.usage`,""]);o&&a.push(o)}if(a.push(...T(t,e,r)),t._examples.length)a.push(e.text(".command-examples"),...t._examples.map(o=>"    "+o));else{let o=e.text([`commands.${t.name}.examples`,""]);o&&a.push(...o.split(`
`).map(d=>"    "+d))}return a.push(...H(".subcommand-prolog",e,t.children,r)),a.filter(Boolean).join(`
`)}h(k,"showHelp")});export default oe();
